(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[418],{8796:function(e,s,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/crudProducts",function(){return a(3174)}])},2049:function(e,s,a){"use strict";var t=a(5893);a(7294);let l=()=>(0,t.jsx)("div",{className:"fixed top-0 left-0 w-screen h-screen z-20",children:(0,t.jsxs)("div",{className:"flex md:flex-row flex-xol flex-wrap justify-center items-center bg-white h-screen sm:px-6 lg:px-8",children:[(0,t.jsxs)("div",{className:"w-full sm:w-80 bg-white rounded-md shadow-xl m-3",children:[(0,t.jsx)("div",{className:"h-44 bg-gray-300 rounded-t-md animate-pulse"}),(0,t.jsxs)("div",{className:"p-5",children:[(0,t.jsx)("div",{className:"h-6 rounded-sm bg-gray-200 duration-75 animate-pulse mb-4"}),(0,t.jsxs)("div",{className:"animate-pulse",children:[(0,t.jsx)("div",{className:"h-1 mt-2 w-1/2 rounded-sm bg-gray-300"}),(0,t.jsx)("div",{className:"h-1 mt-2 w-1/3 rounded-sm bg-gray-300"}),(0,t.jsx)("div",{className:"h-1 mt-2 w-2/3 rounded-sm bg-gray-300"}),(0,t.jsx)("div",{className:"h-1 mt-2 rounded-sm bg-gray-300"}),(0,t.jsx)("div",{className:"h-1 mt-2 rounded-sm bg-gray-300"}),(0,t.jsx)("div",{className:"h-1 mt-2 rounded-sm bg-gray-300"}),(0,t.jsx)("div",{className:"h-2 rounded-sm bg-gray-300"})]})]})]}),(0,t.jsxs)("div",{className:"",children:[(0,t.jsxs)("div",{className:"flex w-screen md:w-full sm:w-96 bg-white rounded-md shadow-xl",children:[(0,t.jsx)("div",{className:"w-1/3 bg-gray-300 rounded-l-md animate-pulse"}),(0,t.jsxs)("div",{className:"p-5 w-3/4",children:[(0,t.jsx)("div",{className:"h-6 rounded-sm bg-gray-200 duration-75 animate-pulse mb-4"}),(0,t.jsxs)("div",{className:"animate-pulse",children:[(0,t.jsx)("div",{className:"h-1 mt-2 w-1/3 rounded-sm bg-gray-300"}),(0,t.jsx)("div",{className:"h-1 mt-2 w-2/3 rounded-sm bg-gray-300"}),(0,t.jsx)("div",{className:"h-1 mt-2 rounded-sm bg-gray-300"}),(0,t.jsx)("div",{className:"h-1 mt-2 rounded-sm bg-gray-300"}),(0,t.jsx)("div",{className:"h-1 mt-2 rounded-sm bg-gray-300"}),(0,t.jsx)("div",{className:"h-2 rounded-sm bg-gray-300"})]})]})]}),(0,t.jsxs)("div",{className:"flex w-screen md:w-full sm:w-96 bg-white rounded-md shadow-xl",children:[(0,t.jsx)("div",{className:"w-1/3 bg-gray-300 rounded-l-md animate-pulse"}),(0,t.jsxs)("div",{className:"p-5 w-3/4",children:[(0,t.jsx)("div",{className:"h-6 rounded-sm bg-gray-200 duration-75 animate-pulse mb-4"}),(0,t.jsxs)("div",{className:"animate-pulse",children:[(0,t.jsx)("div",{className:"h-1 mt-2 w-1/3 rounded-sm bg-gray-300"}),(0,t.jsx)("div",{className:"h-1 mt-2 w-2/3 rounded-sm bg-gray-300"}),(0,t.jsx)("div",{className:"h-1 mt-2 rounded-sm bg-gray-300"}),(0,t.jsx)("div",{className:"h-1 mt-2 rounded-sm bg-gray-300"}),(0,t.jsx)("div",{className:"h-1 mt-2 rounded-sm bg-gray-300"}),(0,t.jsx)("div",{className:"h-2 rounded-sm bg-gray-300"})]})]})]})]})]})});s.Z=l},3174:function(e,s,a){"use strict";a.r(s);var t=a(5893),l=a(7294),d=a(1163),r=a.n(d);a(1955);var c=a(2049),i=a(6154),n=a(2782);let o=()=>{let e=(0,l.useContext)(n.Z),[s,a]=(0,l.useState)(!0),[d,o]=(0,l.useState)(""),[m,u]=(0,l.useState)(""),[x,h]=(0,l.useState)(""),[g,p]=(0,l.useState)(""),[b,j]=(0,l.useState)([]),[f,y]=(0,l.useState)({}),[N,v]=(0,l.useState)(""),[w,S]=(0,l.useState)(!1),[P,k]=(0,l.useState)([]),[C,_]=(0,l.useState)([]),[T,D]=(0,l.useState)(""),[E,q]=(0,l.useState)([]),[F,Z]=(0,l.useState)("");(async function(){let e=localStorage.getItem("token");if(e)try{let s=await fetch("/api/middleware/auth?token=".concat(e),{method:"POST"});s.ok||r().push({pathname:"/login",query:{message:"Token Invalid"}})}catch(e){console.log(e),r().push({pathname:"/login",query:{message:"Token Expired"}})}else r().push({pathname:"/login",query:{message:"Token Invalid"}})})(),(0,l.useEffect)(()=>{let e=setTimeout(()=>{a(!1)},3e3);return()=>clearTimeout(e)},[]);let z=e=>{let s=Array.from(e.target.files).slice(0,4);j(s)},A=()=>{let e={};return d||(e.productName="Product name is required"),m||(e.productDescription="Product description is required"),x||(e.productPrice="Product price is required"),b.length<4?e.imageSrc="Maximum 4 images are allowed":b.length>4&&(e.imageSrc="Only 4 images are allowed"),y(e),0===Object.keys(e).length},I=async e=>{if(e.preventDefault(),A()){a(!0);try{let e=b.map(e=>{let s=new FormData;return s.append("file",e),s.append("upload_preset","uploads"),i.Z.post("https://api.cloudinary.com/v1_1/dvo1ngia7/image/upload",s)}),s=await Promise.all(e),t=s.map(e=>e.data.url),l=await i.Z.post("/api/admin/products",{productName:d,productDescription:m,productCategory:g,productPrice:x,imageUrls:t});console.log(l),v(l.data.message),S(!0),setTimeout(()=>{S(!1)},3e3),a(!1),M()}catch(e){console.log(e),v("Something Went Wrong. "),S(!0),setTimeout(()=>{S(!1)},3e3),a(!1)}}},O=async()=>{try{let e=await i.Z.get("/api/admin/category");_(e.data)}catch(e){v("Internet Connection not Stable"),S(!0),setTimeout(()=>{S(!0)},3e3)}};(0,l.useEffect)(()=>{O()},[]);let M=async()=>{let e=await i.Z.get("/api/admin/products");k(e.data),q(e.data),v(e.data.message),e.data.message};(0,l.useEffect)(()=>{M()},[]);let L=async e=>{a(!0);try{let s=await i.Z.delete("/api/admin/products?id=".concat(e));a(!1),v(s.data.message),S(!0),M()}catch(e){a(!1),v("Something went Wrong, Please Try Again. "),S(!0)}setTimeout(()=>{S(!1)},3e3)};return(0,l.useEffect)(()=>{let s=E.filter(s=>s.name.toLowerCase().includes(e.query.toLowerCase()));0==s.length?Z("Users not Found"):Z(e.query),k(s)},[e.query]),(0,t.jsxs)("div",{children:[s?(0,t.jsx)(c.Z,{}):null,w&&(0,t.jsx)("div",{className:"fixed top-0 left-0 lg:left-auto right-0 z-50 p-4",children:(0,t.jsxs)("div",{className:"mx-auto max-w-sm bg-white rounded-lg shadow-lg flex items-center",children:[(0,t.jsx)("div",{className:"flex-shrink-0",children:(0,t.jsx)("svg",{className:"h-8 w-8 text-gray-400",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",children:(0,t.jsx)("path",{fillRule:"evenodd",d:"M16 10a6 6 0 11-12 0 6 6 0 0112 0zm-6 5a1 1 0 100-2 1 1 0 000 2zm0-10a1 1 0 100-2 1 1 0 000 2zM5.78 14.55a4.002 4.002 0 01-1.513-1.513A5.984 5.984 0 013 10a6 6 0 1111.268 3H13a1 1 0 00-1 1v1a1 1 0 102 0v-1a3 3 0 00-3-3h-.268A5.992 5.992 0 015.78 14.55zM10 12a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"})})}),(0,t.jsx)("div",{className:"ml-4",children:(0,t.jsx)("div",{className:"mt-2 mx-2 text-sm text-gray-500",children:N})})]})}),(0,t.jsxs)("div",{className:"container mx-auto px-4",children:[(0,t.jsx)("h1",{className:"text-2xl font-bold mt-8 mb-4",children:"Product CRUD Page"}),(0,t.jsx)("div",{className:"flex justify-center",children:(0,t.jsxs)("div",{className:"max-w-md w-full",children:[(0,t.jsx)("h2",{className:"text-xl font-bold mb-4 text-center",children:"Add Product"}),(0,t.jsxs)("form",{className:"space-y-6",onSubmit:I,children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-gray-700 font-bold mb-2",htmlFor:"name",children:"Name"}),(0,t.jsx)("input",{className:"block w-full px-4 py-2 border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm",id:"name",type:"text",placeholder:"Product Name",value:d,onChange:e=>o(e.target.value)}),f.productName&&(0,t.jsx)("div",{className:"text-red-500",children:f.productName})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-gray-700 font-bold mb-2",htmlFor:"description",children:"Description"}),(0,t.jsx)("textarea",{className:"block w-full px-4 py-2 border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm",id:"description",placeholder:"Product Description",value:m,onChange:e=>u(e.target.value)}),f.productDescription&&(0,t.jsx)("div",{className:"text-red-500",children:f.productDescription})]}),(0,t.jsxs)("div",{className:"flex flex-col sm:space-x-4",children:[(0,t.jsxs)("div",{className:"w-full sm:w-1/2",children:[(0,t.jsx)("label",{className:"block text-gray-700 font-bold mb-2",htmlFor:"price",children:"Price"}),(0,t.jsx)("input",{className:"block w-full px-4 py-2 border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm",id:"price",type:"number",placeholder:"Product Price",value:x,onChange:e=>h(e.target.value)}),f.productPrice&&(0,t.jsx)("div",{className:"text-red-500",children:f.productPrice})]}),(0,t.jsxs)("div",{className:"w-full sm:w-1/2",children:[(0,t.jsx)("label",{className:"block text-gray-700 font-bold mb-2",htmlFor:"price",children:"Category"}),(0,t.jsxs)("select",{className:"block w-full px-4 py-2 border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm",id:"category",value:g,onChange:e=>p(e.target.value),children:[(0,t.jsx)("option",{value:"",children:"Select a category"}),C.map((e,s)=>(0,t.jsx)("option",{value:e.category,children:e.category}))]}),f.productCategory&&(0,t.jsx)("div",{className:"text-red-500",children:f.productCategory})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"imageFiles",children:"Product Images"}),(0,t.jsx)("input",{type:"file",id:"imageFiles",accept:"image/*",multiple:!0,onChange:z,max:"4"}),f.imageSrc&&(0,t.jsx)("div",{children:f.imageSrc})]})]}),(0,t.jsx)("div",{className:"flex justify-end",children:(0,t.jsx)("button",{type:"submit",className:"inline-flex justify-center w-full sm:w-auto px-4 py-2 bg-blue-500 border border-transparent rounded-md shadow-sm text-base font-medium text-white hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:text-sm",children:"Add Product"})})]})]})}),(0,t.jsxs)("div",{className:"my-8",children:[(0,t.jsx)("h2",{className:"text-xl font-bold mb-4",children:"Product List"}),(0,t.jsx)("div",{className:"overflow-x-auto",children:(0,t.jsxs)("table",{className:"table-auto border-collapse w-full",children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{className:"px-4 py-2 font-bold text-left",children:"Image"}),(0,t.jsx)("th",{className:"px-4 py-2 font-bold text-left",children:"ID"}),(0,t.jsx)("th",{className:"px-4 py-2 font-bold text-left",children:"Name"}),(0,t.jsx)("th",{className:"px-4 py-2 font-bold text-left",children:"Description"}),(0,t.jsx)("th",{className:"px-4 py-2 font-bold text-left",children:"Price"}),(0,t.jsx)("th",{className:"px-4 py-2 font-bold text-left",children:"Category"}),(0,t.jsx)("th",{className:"px-4 py-2 font-bold text-left",children:"Actions"})]})}),(0,t.jsx)("tbody",{children:P.map((e,s)=>(0,t.jsxs)("tr",{children:[(0,t.jsxs)("td",{className:"border px-4 py-2",children:[" ",(0,t.jsx)("img",{src:e.images[0]})," "]}),(0,t.jsx)("td",{className:"border px-4 py-2",children:e._id}),(0,t.jsx)("td",{className:"border px-4 py-2",children:e.name}),(0,t.jsx)("td",{className:"border px-4 py-2",children:e.description}),(0,t.jsx)("td",{className:"border px-4 py-2",children:e.price}),(0,t.jsx)("td",{className:"border px-4 py-2",children:e.category}),(0,t.jsx)("td",{className:"border px-4 py-2",children:(0,t.jsx)("button",{className:"bg-red-500 hover:bg-red-700 text-white font-bold py-2 px-4 rounded",onClick:()=>L(e._id),children:"Delete"})})]}))})]})})]})]})]})};s.default=o}},function(e){e.O(0,[774,888,179],function(){return e(e.s=8796)}),_N_E=e.O()}]);